# 第五章-中央处理器

# 本章总览

![Img](./FILES/第五章-中央处理器.md/img-20231228213402.png)

# CPU的功能和基本结构

## cpu的功能

1. 指令控制
2. 操作控制
3. 时间控制
4. 数据加工
5. 中断处理
![Img](./FILES/第五章-中央处理器.md/img-20231228213649.png)


## 运算器和控制器的功能

![Img](./FILES/第五章-中央处理器.md/img-20231228213803.png)


## 运算器的基本结构

![Img](./FILES/第五章-中央处理器.md/img-20231228214202.png)

![Img](./FILES/第五章-中央处理器.md/img-20231228214534.png)

## 控制器的基本结构

![Img](./FILES/第五章-中央处理器.md/img-20231228214856.png)


## cpu的基本结构

![Img](./FILES/第五章-中央处理器.md/img-20231228214951.png)

![Img](./FILES/第五章-中央处理器.md/img-20231228214958.png)


## 本节回顾

![Img](./FILES/第五章-中央处理器.md/img-20231228215009.png)

# 指令执行过程

## 指令周期i

![Img](./FILES/第五章-中央处理器.md/img-20231229091815.png)

指令周期常常用若干机器周期来表示，机器周期又叫做cpu周期

一个机器周期又包含若干个时钟周期（也称为节拍，T周期或者cpu时钟周期，它是cpu操作的最基本的单位）

![Img](./FILES/第五章-中央处理器.md/img-20231229092131.png)

![Img](./FILES/第五章-中央处理器.md/img-20231229092336.png)


## 指令周期流程

![Img](./FILES/第五章-中央处理器.md/img-20231229092455.png)


## 指令周期的数据流-取指周期

![Img](./FILES/第五章-中央处理器.md/img-20231229092557.png)


## 指令周期的数据流-间址周期

![Img](./FILES/第五章-中央处理器.md/img-20231229092711.png)


## 指周期的数据流-执行周期

![Img](./FILES/第五章-中央处理器.md/img-20231229092737.png)


## 指令周期的数据流-中断周期

![Img](./FILES/第五章-中央处理器.md/img-20231229093016.png)



## 指令执行方案

![Img](./FILES/第五章-中央处理器.md/img-20231229093311.png)


##  本节回顾

![Img](./FILES/第五章-中央处理器.md/img-20231229093422.png)


# 数据通路的功能-单总线结构

![Img](./FILES/第五章-中央处理器.md/img-20231229093509.png)

## 数据通路

![Img](./FILES/第五章-中央处理器.md/img-20231229093617.png)

## cpu内部单总线方式

1. 寄存器之间的数据传送
2. 主存与cpu之间的数据传送
3. 执行算数或逻辑运算

![Img](./FILES/第五章-中央处理器.md/img-20231229094245.png)

## cpu内部单总线方式-例题

![Img](./FILES/第五章-中央处理器.md/img-20231229094824.png)

![Img](./FILES/第五章-中央处理器.md/img-20231229094925.png)

![Img](./FILES/第五章-中央处理器.md/img-20231229095003.png)



## 本节回顾

![Img](./FILES/第五章-中央处理器.md/img-20231229095106.png)

# 数据通路-专用数据通路
![Img](./FILES/第五章-中央处理器.md/img-20231229095239.png)

## 取值周期

![Img](./FILES/第五章-中央处理器.md/img-20231229095439.png)



## 例题

![Img](./FILES/第五章-中央处理器.md/img-20231229095608.png)

![Img](./FILES/第五章-中央处理器.md/img-20231229095703.png)

![Img](./FILES/第五章-中央处理器.md/img-20231229095828.png)



## 本节回顾

![Img](./FILES/第五章-中央处理器.md/img-20231229100113.png)



# 硬布线控制器

## 内容回顾

![Img](./FILES/第五章-中央处理器.md/img-20231229100616.png)


## 硬布线控制器
![Img](./FILES/第五章-中央处理器.md/img-20231229100942.png)

![Img](./FILES/第五章-中央处理器.md/img-20231229100953.png)

## 硬布线控制器的设计

![Img](./FILES/第五章-中央处理器.md/img-20231229101244.png)


## 1.分析每个阶段的位操作序列

![Img](./FILES/第五章-中央处理器.md/img-20231229101517.png)

## 2.选择cpu的控制方式
![Img](./FILES/第五章-中央处理器.md/img-20231229101626.png)

## 3.安排微操作时序

### 取指周期
![Img](./FILES/第五章-中央处理器.md/img-20231229101837.png)

### 间址周期
![Img](./FILES/第五章-中央处理器.md/img-20231229101857.png)

### 执行周期
![Img](./FILES/第五章-中央处理器.md/img-20231229101930.png)

![Img](./FILES/第五章-中央处理器.md/img-20231229101958.png)


### 中断周期
暂无

## 4.电路设计
### 组合逻辑设计

![Img](./FILES/第五章-中央处理器.md/img-20231229102023.png)


![Img](./FILES/第五章-中央处理器.md/img-20231229102238.png)

![Img](./FILES/第五章-中央处理器.md/img-20231229102322.png)

![Img](./FILES/第五章-中央处理器.md/img-20231229102426.png)

### 画出电路图

![Img](./FILES/第五章-中央处理器.md/img-20231229102627.png)

## 总结

![Img](./FILES/第五章-中央处理器.md/img-20231229102811.png)

# 微程序控制器的基本原理

## 设计思路

![Img](./FILES/第五章-中央处理器.md/img-20231229103745.png)

## 基本结构
![Img](./FILES/第五章-中央处理器.md/img-20231229104225.png)

## 工作原理


![Img](./FILES/第五章-中央处理器.md/img-20231229104610.png)

## 微程序控制器总结

![Img](./FILES/第五章-中央处理器.md/img-20231229104630.png)

# 微指令的设计

![Img](./FILES/第五章-中央处理器.md/img-20231229104910.png)

## 微指令的格式

+ 水平型微指令
+ 垂直型微指令
+ 混合型微指令

![Img](./FILES/第五章-中央处理器.md/img-20231229105051.png)

## 微指令的编码方式

![Img](./FILES/第五章-中央处理器.md/img-20231229105151.png)

![Img](./FILES/第五章-中央处理器.md/img-20231229105349.png)

![Img](./FILES/第五章-中央处理器.md/img-20231229105711.png)


## 例题
![Img](./FILES/第五章-中央处理器.md/img-20231229105515.png)




## 微指令的地址形成方式

![Img](./FILES/第五章-中央处理器.md/img-20231229105819.png)

![Img](./FILES/第五章-中央处理器.md/img-20231229105842.png)


## 例题 断定方式

![Img](./FILES/第五章-中央处理器.md/img-20231229110011.png)

## 知识回顾

![Img](./FILES/第五章-中央处理器.md/img-20231229110021.png)


# 微程序控制单元的设计

![Img](./FILES/第五章-中央处理器.md/img-20231229112118.png)

![Img](./FILES/第五章-中央处理器.md/img-20231229112241.png)

微程序控制器的速度比硬布线控制器更慢


![Img](./FILES/第五章-中央处理器.md/img-20231229112415.png)

![Img](./FILES/第五章-中央处理器.md/img-20231229112528.png)

![Img](./FILES/第五章-中央处理器.md/img-20231229112539.png)


## 微程序设计分类

![Img](./FILES/第五章-中央处理器.md/img-20231229112627.png)


## 硬布线与微程序的比较

![Img](./FILES/第五章-中央处理器.md/img-20231229112738.png)


## 微程序控制器回顾

![Img](./FILES/第五章-中央处理器.md/img-20231229112807.png)

# 指令流水线及性能指标


## 问题引入

![Img](./FILES/第五章-中央处理器.md/img-20231229112957.png)

## 指令流水线的定义
![Img](./FILES/第五章-中央处理器.md/img-20231229113131.png)


## 流水线的表示方法

1. 指令执行过程图
2. 时空图 

![Img](./FILES/第五章-中央处理器.md/img-20231229113222.png)

## 流水线的性能指标

### 吞吐率

![Img](./FILES/第五章-中央处理器.md/img-20231229113403.png)

### 加速比
![Img](./FILES/第五章-中央处理器.md/img-20231229113434.png)

### 效率

![Img](./FILES/第五章-中央处理器.md/img-20231229113530.png)

## 本节回顾

![Img](./FILES/第五章-中央处理器.md/img-20231229113614.png)

## 指令流水线影响因素分类

## 机器周期的设置

五段式指令流水线（mips）

![Img](./FILES/第五章-中央处理器.md/img-20231229114215.png)


## 影响因素

1. 结构相关（资源冲突）（互斥）
2. 数据相关（数据冲突）（同步）
3. 控制相关（控制冲突）

### 结构相关

![Img](./FILES/第五章-中央处理器.md/img-20231229114624.png)


### 数据相关
1. 硬件阻塞stall
2. 软件插入nop
3. 数据旁路
4. 编译优化

![Img](./FILES/第五章-中央处理器.md/img-20231229114904.png)

![Img](./FILES/第五章-中央处理器.md/img-20231229114946.png)

![Img](./FILES/第五章-中央处理器.md/img-20231229115105.png)

### 控制相关
![Img](./FILES/第五章-中央处理器.md/img-20231229115617.png)

## 影响因素总结

![Img](./FILES/第五章-中央处理器.md/img-20231229115632.png)

## 流水线的分类

![Img](./FILES/第五章-中央处理器.md/img-20231229115945.png)

![Img](./FILES/第五章-中央处理器.md/img-20231229120235.png)

## 流水线多发技术

### 超标量技术
![Img](./FILES/第五章-中央处理器.md/img-20231229120337.png)

### 超流水技术
![Img](./FILES/第五章-中央处理器.md/img-20231229120508.png)


### 超长指令字
![Img](./FILES/第五章-中央处理器.md/img-20231229120622.png)

## 本节回顾

![Img](./FILES/第五章-中央处理器.md/img-20231229120604.png)

# 五段式指令流水线

![Img](./FILES/第五章-中央处理器.md/img-20231229135100.png)

## 运算类指令的执行过程

![Img](./FILES/第五章-中央处理器.md/img-20231229135526.png)


## load指令的执行过程

![Img](./FILES/第五章-中央处理器.md/img-20231229135726.png)

## store指令的执行过程
![Img](./FILES/第五章-中央处理器.md/img-20231229135856.png)

## 条件转移指令的执行过程

![Img](./FILES/第五章-中央处理器.md/img-20231229140122.png)

## 无条件转移指令的执行过程

![Img](./FILES/第五章-中央处理器.md/img-20231229140319.png)

## 例题

![Img](./FILES/第五章-中央处理器.md/img-20231229140607.png)

# 多处理器的基本概念
![Img](./FILES/第五章-中央处理器.md/img-20231229140825.png)


## sisd

![Img](./FILES/第五章-中央处理器.md/img-20231229141051.png)


![Img](./FILES/第五章-中央处理器.md/img-20231229140819.png)

## simd

![Img](./FILES/第五章-中央处理器.md/img-20231229141024.png)

![Img](./FILES/第五章-中央处理器.md/img-20231229141035.png)

## misd

![Img](./FILES/第五章-中央处理器.md/img-20231229141131.png)

## mimd
![Img](./FILES/第五章-中央处理器.md/img-20231229141257.png)


![Img](./FILES/第五章-中央处理器.md/img-20231229141153.png)


![Img](./FILES/第五章-中央处理器.md/img-20231229141309.png)

## 向量处理器的基本概念

![Img](./FILES/第五章-中央处理器.md/img-20231229141621.png)


![Img](./FILES/第五章-中央处理器.md/img-20231229141608.png)

## 共享内存多处理器和多核处理器

![Img](./FILES/第五章-中央处理器.md/img-20231229141711.png)

![Img](./FILES/第五章-中央处理器.md/img-20231229141728.png)

# 硬件多线程

## 知识总览
![Img](./FILES/第五章-中央处理器.md/img-20231229141751.png)

![Img](./FILES/第五章-中央处理器.md/img-20231229141927.png)

## 三种硬件多线程
![Img](./FILES/第五章-中央处理器.md/img-20231229141815.png)

![Img](./FILES/第五章-中央处理器.md/img-20231229142029.png)




























































