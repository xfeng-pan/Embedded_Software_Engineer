# 第四章-指令系统

# 指令格式
![Img](./FILES/第四章-指令系统.md/img-20231228131619.png)

## 指令的定义

式知识计算机执行某种操作的指令，式计算机运行的最小功能单位

![Img](./FILES/第四章-指令系统.md/img-20231228131711.png)

##指令格式
![Img](./FILES/第四章-指令系统.md/img-20231228131734.png)


## 零地址指令

![Img](./FILES/第四章-指令系统.md/img-20231228131846.png)


## 一地址指令

![Img](./FILES/第四章-指令系统.md/img-20231228132022.png)

## 二，三地址指令

![Img](./FILES/第四章-指令系统.md/img-20231228132057.png)


## 四地址指令

![Img](./FILES/第四章-指令系统.md/img-20231228132232.png)



![Img](./FILES/第四章-指令系统.md/img-20231228132252.png)

## 指令-按照指令长度分类

![Img](./FILES/第四章-指令系统.md/img-20231228132342.png)

## 指令-按操作码长度分类

![Img](./FILES/第四章-指令系统.md/img-20231228132419.png)

## 指令-按操作类型分类

![Img](./FILES/第四章-指令系统.md/img-20231228132515.png)

![Img](./FILES/第四章-指令系统.md/img-20231228132534.png)


## 本节回顾

![Img](./FILES/第四章-指令系统.md/img-20231228132545.png)


# 扩展操作码

## 本节总览

![Img](./FILES/第四章-指令系统.md/img-20231228132611.png)


## 扩展操作吗
![Img](./FILES/第四章-指令系统.md/img-20231228132716.png)


![Img](./FILES/第四章-指令系统.md/img-20231228132806.png)

![Img](./FILES/第四章-指令系统.md/img-20231228132940.png)



## 指令操作码

![Img](./FILES/第四章-指令系统.md/img-20231228133207.png)


# 指令寻址

## 知识总览

![Img](./FILES/第四章-指令系统.md/img-20231228133236.png)

## 指令寻址

![Img](./FILES/第四章-指令系统.md/img-20231228133606.png)

![Img](./FILES/第四章-指令系统.md/img-20231228133652.png)

![Img](./FILES/第四章-指令系统.md/img-20231228133816.png)

## 本节回顾

![Img](./FILES/第四章-指令系统.md/img-20231228133837.png)


# 数据寻址

## 指令寻址 vs 数据寻址
![Img](./FILES/第四章-指令系统.md/img-20231228134526.png)

## 知识总览

![Img](./FILES/第四章-指令系统.md/img-20231228134558.png)

![Img](./FILES/第四章-指令系统.md/img-20231228134630.png)

## 直接寻址

![Img](./FILES/第四章-指令系统.md/img-20231228143140.png)


## 间接寻址

![Img](./FILES/第四章-指令系统.md/img-20231228143257.png)

![Img](./FILES/第四章-指令系统.md/img-20231228143343.png)

## 寄存器寻址

![Img](./FILES/第四章-指令系统.md/img-20231228143427.png)


## 寄存器间接寻址

![Img](./FILES/第四章-指令系统.md/img-20231228143500.png)


## 隐含寻址

![Img](./FILES/第四章-指令系统.md/img-20231228143530.png)

## 立即寻址
![Img](./FILES/第四章-指令系统.md/img-20231228143651.png)


## 本节回顾

![Img](./FILES/第四章-指令系统.md/img-20231228143710.png)

# 数据寻址2

## 偏移寻址

![Img](./FILES/第四章-指令系统.md/img-20231228143810.png)

### 基址寻址

![Img](./FILES/第四章-指令系统.md/img-20231228144009.png)

![Img](./FILES/第四章-指令系统.md/img-20231228144326.png)



### 基址寻址的作用

![Img](./FILES/第四章-指令系统.md/img-20231228144218.png)


### 变址寻址



![Img](./FILES/第四章-指令系统.md/img-20231228144510.png)

![Img](./FILES/第四章-指令系统.md/img-20231228150426.png)


### 变址寻址的作用

![Img](./FILES/第四章-指令系统.md/img-20231228145835.png)

![Img](./FILES/第四章-指令系统.md/img-20231228150350.png)


### 基址寻址 & 变址寻址的复合寻址

![Img](./FILES/第四章-指令系统.md/img-20231228150529.png)


### 相对寻址

![Img](./FILES/第四章-指令系统.md/img-20231228150641.png)

![Img](./FILES/第四章-指令系统.md/img-20231228150833.png)

![Img](./FILES/第四章-指令系统.md/img-20231228150950.png)


## 本节回顾

![Img](./FILES/第四章-指令系统.md/img-20231228151011.png)

## 硬件如何实现数的比较

![Img](./FILES/第四章-指令系统.md/img-20231228152331.png)

# 数据寻址3

## 本节总览

![Img](./FILES/第四章-指令系统.md/img-20231228152404.png)

## 堆栈寻址

![Img](./FILES/第四章-指令系统.md/img-20231228152618.png)


![Img](./FILES/第四章-指令系统.md/img-20231228152706.png)

## 本节回顾

![Img](./FILES/第四章-指令系统.md/img-20231228152746.png)


# 高级语言与机器代码之间的对应

## 本节总览

![Img](./FILES/第四章-指令系统.md/img-20231228152813.png)


## 高级语言-汇编语言-机器语言

![Img](./FILES/第四章-指令系统.md/img-20231228152959.png)

## x86汇编语言指令基础

指令的作用
1. 改变程序执行流
2. 处理数据

指令格式：操作码 +  地址码
![Img](./FILES/第四章-指令系统.md/img-20231228153258.png)

## 以mov指令为例



![Img](./FILES/第四章-指令系统.md/img-20231228153452.png)


## x86架构cpu有那些寄存器

![Img](./FILES/第四章-指令系统.md/img-20231228153925.png)

![Img](./FILES/第四章-指令系统.md/img-20231228154010.png)


![Img](./FILES/第四章-指令系统.md/img-20231228154122.png)


## 更多例子

![Img](./FILES/第四章-指令系统.md/img-20231228154258.png)


## 总结

![Img](./FILES/第四章-指令系统.md/img-20231228154341.png)

# 常用X86指令

## 常见的算数运算指令

![Img](./FILES/第四章-指令系统.md/img-20231228155754.png)

x86中不允许两个操作数都来自与主存

## 常见的逻辑运算指令

![Img](./FILES/第四章-指令系统.md/img-20231228160049.png)

## 其它指令

![Img](./FILES/第四章-指令系统.md/img-20231228160106.png)


# AT&T vs INTEL格式

前者用于linux的常用格式

后者是windows的常用格式

![Img](./FILES/第四章-指令系统.md/img-20231228160353.png)

![Img](./FILES/第四章-指令系统.md/img-20231228160649.png)


# 选择语句的机器级表示

## 程序中的选择语句（分支结构）

![Img](./FILES/第四章-指令系统.md/img-20231228160827.png)

## 无条件转移指令-jmp

![Img](./FILES/第四章-指令系统.md/img-20231228161036.png)


![Img](./FILES/第四章-指令系统.md/img-20231228161127.png)


## 条件转移指令 -jxxx

![Img](./FILES/第四章-指令系统.md/img-20231228161622.png)


## 示例

![Img](./FILES/第四章-指令系统.md/img-20231228161653.png)

![Img](./FILES/第四章-指令系统.md/img-20231228161907.png)

写汇编语言代码的时候，一般会使用函数的名字作为”标号“使用


## 扩展：cmp指令的底层逻辑

![Img](./FILES/第四章-指令系统.md/img-20231228162116.png)

# 循环语句的机器级表示

## 使用条件转移指令实现循环

![Img](./FILES/第四章-指令系统.md/img-20231228184018.png)

![Img](./FILES/第四章-指令系统.md/img-20231228184155.png)


## 用LOOP指令实现循环

![Img](./FILES/第四章-指令系统.md/img-20231228184301.png)

理论上，能用loop指令实现的功能一定能用条件转移指令实现

补充：
loopx指令 ：loopnz，loopz

![Img](./FILES/第四章-指令系统.md/img-20231228184441.png)

# 函数调用的机器级表示 call ret

![Img](./FILES/第四章-指令系统.md/img-20231228184627.png)

## x86汇编语言的函数调用
![Img](./FILES/第四章-指令系统.md/img-20231228184724.png)

## call 与 ret

![Img](./FILES/第四章-指令系统.md/img-20231228184841.png)


## 总结

![Img](./FILES/第四章-指令系统.md/img-20231228185841.png)


# 函数调用的机器级表示-如何访问栈帧的数据

## 函数调用栈在内粗中的位置

![Img](./FILES/第四章-指令系统.md/img-20231228190016.png)


## 标记栈帧范围：ebp esp

![Img](./FILES/第四章-指令系统.md/img-20231228190041.png)


![Img](./FILES/第四章-指令系统.md/img-20231228190144.png)

![Img](./FILES/第四章-指令系统.md/img-20231228190151.png)

## 访问栈帧数据 push pop

![Img](./FILES/第四章-指令系统.md/img-20231228190328.png)

## 访问栈帧数据 mov

![Img](./FILES/第四章-指令系统.md/img-20231228202318.png)


## 总结

![Img](./FILES/第四章-指令系统.md/img-20231228202349.png)


# 函数调用的机器级表示-如何切换栈帧

![Img](./FILES/第四章-指令系统.md/img-20231228202620.png)

![Img](./FILES/第四章-指令系统.md/img-20231228202729.png)

## 总结

![Img](./FILES/第四章-指令系统.md/img-20231228202903.png)


![Img](./FILES/第四章-指令系统.md/img-20231228203816.png)

![Img](./FILES/第四章-指令系统.md/img-20231228203844.png)


# 函数调用的机器级表示-栈帧的内容与参数，返回值传递

## 栈帧可能包含的内容

![Img](./FILES/第四章-指令系统.md/img-20231228205153.png)


![Img](./FILES/第四章-指令系统.md/img-20231228205253.png)

## 汇编代码实战

![Img](./FILES/第四章-指令系统.md/img-20231228205837.png)


## 扩展

![Img](./FILES/第四章-指令系统.md/img-20231228205936.png)

![Img](./FILES/第四章-指令系统.md/img-20231228205951.png)

## 总结

![Img](./FILES/第四章-指令系统.md/img-20231228210919.png)


# 指令系统 CISC RISC

CISC：复杂指令集系统（x86架构）
RISC：精简指令集系统（arm架构）

![Img](./FILES/第四章-指令系统.md/img-20231228211510.png)

![Img](./FILES/第四章-指令系统.md/img-20231228211804.png)





























